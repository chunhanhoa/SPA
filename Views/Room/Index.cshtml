@model IEnumerable<QL_Spa.Models.Room>

@{
    ViewData["Title"] = "Danh sách phòng";
}

<h1>Danh sách phòng</h1>

<div class="mb-3">
    <button id="refreshButton" class="btn btn-primary">Làm mới dữ liệu</button>
</div>

<div id="roomsContainer">
    <div class="text-center">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <p>Đang tải dữ liệu...</p>
    </div>
</div>

<!-- Debug section - can be removed in production -->
<div class="mt-4 card">
    <div class="card-header">
        <button class="btn btn-sm btn-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#debugInfo">
            Debug Information
        </button>
    </div>
    <div class="collapse" id="debugInfo">
        <div class="card-body">
            <h5>API Response</h5>
            <pre id="apiResponse">No data yet</pre>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/room.js"></script>
    <script>
        // Add debug and refresh functionality
        document.getElementById('refreshButton').addEventListener('click', function() {
            loadRooms();
        });
        
        // Override fetch for debugging
        const originalFetch = window.fetch;
        window.fetch = function() {
            return originalFetch.apply(this, arguments)
                .then(response => {
                    if (response.ok) {
                        // Clone the response to avoid consuming it
                        const clonedResponse = response.clone();
                        clonedResponse.json().then(data => {
                            document.getElementById('apiResponse').textContent = JSON.stringify(data, null, 2);
                        });
                    }
                    return response;
                });
        }
    </script>
}
